<!doctype html>
<html lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Document</title>
		<link rel="stylesheet" type="text/css" href="../../css/ct.css" />
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
       <style>
       body{
          	min-width: 320px;
         }
          .details_title{
          	line-height: 50px;
          	background-color: #fff;
          }
          .upan_name{
          	text-align: center;
          	font-weight: 700;
          	padding-right: 10px;
          }
          .u_jiage{
          	text-align: center;
          }
          .jiage_wen{
          	color: #999;
          	font-size: 0.8em;
         
          }
          .jiage_num{
          	font-size: 1.4em;
          	color: red;
          }
          .t_package_center{
             line-height: 35px;
             padding-left: 2em;
             font-size: 0.9em;
          }
       	 .measure_view {
       background-color: #F8F8F8;
       	position: relative;
       	padding: 5px 5px 0 5px;
       }
       .measure_view_left,
       .measure_view_right
       {
       	background-color: #fff;
       	margin: 5px 5px 0 5px;
       }
       .img {
       	background: no-repeat;
       	background-size: cover;
       	height: 120px;
       	max-width: 120px;
       }
       .img-frm{
       	background: url(../../image/measure_list.png) no-repeat center;
       	background-size: cover;
       	height: 120px;
       	max-width: 120px;
       	position: relative;
       	margin-left: -60px;
       	left: 50%;
       }
       	#main, .main{
       		padding-bottom: 90px;
       	}
          .p_titel{
       		text-align: left;
       		padding:  0.8em;
       		font-weight:600;
       		font-size: 0.8em;
       		height: 55px;
       	}
       .measur_font{
       		font-size: 0.7em;
       		color: #999;
       		padding: 0 .6em;
       		word-break: break-word;
       		line-height: 15px;
       	}
       	.yuan{
       		color: red;
       		text-align: center;
       		line-height: 25px;
       		font-weight: 600;
       		font-size: 1.1em;
       	}
   
       	.meiyuan{
       		font-size: 0.6em;
       		color: red;
       		
       	}
       	.pingjia{
       		text-align: right;
       		margin-right: 5px;
       		font-size: 0.6em;

       		margin-top: -8px;
       		margin-bottom: 5px;
       	}
      
		.tuwen_details{
			margin-top: 10px;
			line-height: 50px;
			background-color: #fff;
			border: 1px solid #ededed;
		}
		.tuwen{
			font-size: 25px;
			margin-right: 0.5em;
			margin-left: 0.5em;
			margin-top: 0.5em;
			color: #999;
		}
		.ce_datails
		{
			color: #000;
			
		}
		.tuwen_details .datails_wifi{
			color: #999;
			font-size: 0.8em;
			line-height: 52px;;
		}
		.text-pingjia{
			line-height: 50px;
			border-bottom:1px solid #ededed;
			background-color: #fff;
			
		}
       </style>
	</head>

	<body style="background-color:#F8F8F8">
		<div id="wrap">
			<div id="main">
				<div class="flex-box details_title hidden">
					<div class="flex-1 upan_name">U盘可靠性试验</div>
					<div class="flex-1 u_jiage">
						<span class="jiage_wen">价格:</span>
						<span class="jiage_num">￥620.00</span>
					</div>
				</div>
				<p class="t_package_center hidden">套餐测试内容</p>
				<div class="measure-list hidden">
					<div class="flex-box measure_view">
						<div class="measure_view_left">
							<div class="img-frm">
								<div class="img"></div>
							</div>
							<p class="p_titel">高温高湿high temp.&high humi</p>
				
							<p class="yuan"><span class="meiyuan">￥</span>520.00</p>
							<p class="pingjia"><span class="ct-icon-news ji_color" style="color:#F8F8F;">(10)</span></p>
						</div>
						<div class="measure_view_right">
							<div class="img-frm">
								<div class="img"></div>
							</div>
							<p class="p_titel">耐焊接热(DIP方式)</p>
				
							<p class="yuan"><span class="meiyuan">￥</span>520.00</p>
							<p class="pingjia"><span class="ct-icon-news ji_color" style="color:#F8F8F;">(10)</span></p>
						</div>
					</div>
					<div class="flex-box measure_view">
						<div class="measure_view_left">
							<div class="img-frm">
								<div class="img"></div>
							</div>
							<p class="p_titel">高温高湿high temp.&high humi</p>
				
							<p class="yuan"><span class="meiyuan">￥</span>520.00</p>
							<p class="pingjia"><span class="ct-icon-news ji_color" style="color:#F8F8F;">(10)</span></p>
						</div>
						<div class="measure_view_right">
							<div class="img-frm">
								<div class="img"></div>
							</div>
							<p class="p_titel">耐焊接热(DIP方式)</p>
				
							<p class="yuan"><span class="meiyuan">￥</span>520.00</p>
							<p class="pingjia"><span class="ct-icon-news ji_color" style="color:#F8F8F;">(10)</span></p>
						</div>
					</div>
					<div class="flex-box tuwen_details">
						<span class="ct-icon-nickname tuwen" style=""></span>
						<span class="ce_datails">测试图文详情</span>
						<span class="datails_wifi">（建议在wifi下查看）</span>
					</div>
					<div class="flex-box text-pingjia" onclick="">
						<span class="ct-icon-join tuwen"></span>
						<span class="ce_datails">测试评价</span>
						<span class="ce_datails">（18）</span>
					</div>
					<div class="flex-box text-pingjia">
						<span class="ct-icon-star tuwen"></span>
						<span class="ce_datails">收藏测试</span>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="../../script/api.js"></script>
	<script type="text/javascript" src="../../script/common.js" ></script>
	<script type="text/javascript" src="../../script/doT.min.js" ></script>
	<script type="text/javascript" src="../../script/echo.js" ></script>
	<script type="text/javascript" src="../../script/cart.js" ></script>
	<script type="text/template" template="main">
		<div style="background-color:#F8F8F8">
		   <div class="flex-box details_title">
					<div class="flex-1 upan_name">{{= it.title}}</div>
					<div class="flex-1 u_jiage">
						<span class="jiage_wen">价格:</span>
						<span class="jiage_num">￥{{= it.price}}/{{= it.comment}}</span>
					</div>
				</div>
				<p class="t_package_center">套餐测试内容</p>
				<div class="measure-list">
					{{~it.Etest :value:index}}
					{{? index%2==0}}
			     <div class="measure-list" onclick="SingleListDetail({{= value.id}})">
							<div class="flex-box measure_view">
								<div style="width:{{= (api.frameWidth-30)/2 }}px;background-color: ;" tapmode="" class=" measure_view_left">
									<div class="img-frm" >
										<div class="img" data-echo-background="{{= value.etest_cover }}"></div>
									</div>
										<p class="p_titel">{{= value.etest_title}}</p>
										<p class="yuan"><span class="meiyuan">￥</span>{{= value.etest_price}}</p>
										<p class="pingjia"><span class="ct-icon-news ji_color" style="color:#F8F8F;">({{= value.etest_comment }})</span></p>
								</div>
								{{? index+1<it.Etest.length}}
								<div class="measure_view_right" style="width:{{= (api.frameWidth-30)/2 }}px;background-color: ;">
									<div class="img-frm">
										<div class="img" data-echo-background="{{= it.Etest[index+1].etest_cover }}"></div>
									</div>
										<p class="p_titel">{{= it.Etest[index+1].etest_title }}</p>
										<p class="yuan"><span class="meiyuan">￥</span>{{= it.Etest[index+1].etest_price }}</p>
										<p class="pingjia"><span class="ct-icon-news ji_color" style="color:#F8F8F;">({{= it.Etest[index+1].etest_comment }})</span></p>
								</div>
								{{?}}
							</div>
						</div>	
					{{?}}
			  {{~}}
					<div class="flex-box tuwen_details" onclick="openDescription({{= it.etestpackage_id}})" tapmode="">
						<span class="ct-icon-nickname tuwen" style=""></span>
						<span class="ce_datails">测试图文详情</span>
						<span class="datails_wifi">（建议在wifi下查看）</span>
					</div>
					<div class="flex-box text-pingjia" onclick="openStarCommentList('ETest', 'etestComment', {{=it.etestpackage_id}}, 2)">
						<span class="ct-icon-join tuwen"></span>
						<span class="ce_datails">测试评价</span>
						<span class="ce_datails">（{{= it.comment}}）</span>
					</div>
					{{? $api.getStorage('memberInfo') }}
						<div class="flex-box text-pingjia " onclick="etestpackagecollection('{{= it.etestpackage_id }}')" tapmode=""> 
							{{ if($api.getStorage('memberInfo')){ }}
								{{ if($api.getStorage('memberInfo').etestpackagecollection.indexOf(it.etestpackage_id.toString())>=0){ }}						
									<span class="ct-icon-star_select tuwen collect" ></span>
							{{ }else{ }}		
									<span class="ct-icon-star tuwen collect" tapmode=""></span>
								{{ } }}
							{{ } }}
							<span class="ce_datails">收藏测试</span>
					  </div>
				  {{?}}
				</div>
			</div>	
	</script>
	<script type="text/javascript">
	//预定义变量，用于加入测试车
		var tid, price, title, cover;
		function addCart(){
			Cart.push({
				cartName: 'enterpriseTestCart',
				goods: {
					type: 1,
					tid: tid,
					title: title,
					price: price,
					cover: cover,
					num: 1
				}
			});
			toast('添加测试车成功');			
		}
		function etestpackagecollection(etestpackage_id){
			var flag = 0;
			if(!$api.hasCls($api.dom('.collect'), 'ct-icon-star_select')){
				flag = 1;
			}
			tool.ajax.get({
				hideLoading:true,
				ctrl: 'ETest',
				fn: 'etestCollect',
				data: {
					values: {
						id: $api.getStorage('memberId'),
						token: $api.getStorage('token'),
						type:1,
						tid: etestpackage_id
					}
				}
			}, function(ct){
				var memberInof = $api.getStorage('memberInfo');
				if(flag){
					toast('收藏成功');
					$api.addCls($api.removeCls($api.dom('.collect'), 'ct-icon-star'), 'ct-icon-star_select');
					memberInof.etestpackagecollection.push(etestpackage_id);
				}else{
					toast('已取消收藏');
					$api.addCls($api.removeCls($api.dom('.collect'), 'ct-icon-star_select'), 'ct-icon-star');
					var _index = memberInof.etestpackagecollection.indexOf(etestpackage_id);
					memberInof.etestpackagecollection.splice(_index, 1);
				}
				$api.setStorage('memberInfo', memberInof);
			});
		}	
	function openComment(){
		api.openWin({
				name: 'etest',
				url: api.wgtRootDir + '/html/window/win.html',
				pageParam: {
					headerTitle: '评论列表',
					frameName: '_etest_comment',
					frameUrl: api.wgtRootDir + '/html/home/etest_comment.html'
				},
				bounces: false
			});	
	}
			//图文详情
	function openDescription(id){
			api.openWin({
				name: 'Description',
				url: api.wgtRootDir + '/html/window/win.html',
				pageParam: {
					headerTitle: '图文详情',
					frameName: '_description',
					frameUrl: api.wgtRootDir + '/html/home/description.html',
					hasFrameParam: true,
					frameParam: {
						id: id,
						type: 5
					}
				},
				bounces: false
			});			
		}
	function reload(id){
		tool.ajax.get({
			ctrl:"ETest",
			fn:"etestPackageDetail",
			hideLoading:true,
			data:{
				 values:{
				 	etpid:id
				 }
			}
		},function(ct){
			tid = ct.etestpackage_id;
			title = ct.title;
			price = ct.price;
			cover = ct.cover[0];
			mt('#main', 'main', ct);
//		  $api.html($api.dom('#main'), doT.template($api.html($api.dom('[template=main]')))(ct));
	    echo.init();
			api.parseTapmode();
		});
	}
		apiready = function(){
			reload(api.pageParam.id);
		}
	</script>
</html> 
